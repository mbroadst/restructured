'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"]) _i["return"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError("Invalid attempt to destructure non-iterable instance"); } }; }();

var _lodash = require('lodash');

var _lodash2 = _interopRequireDefault(_lodash);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var PunctuationOpeners = '"\'(<\\[{\u0F3A\u0F3C\u169B\u2045\u207D\u208D\u2329\u2768' + '\u276A\u276C\u276E\u2770\u2772\u2774\u27C5\u27E6\u27E8\u27EA' + '\u27EC\u27EE\u2983\u2985\u2987\u2989\u298B\u298D\u298F\u2991' + '\u2993\u2995\u2997\u29D8\u29DA\u29FC\u2E22\u2E24\u2E26\u2E28' + '\u3008\u300A\u300C\u300E\u3010\u3014\u3016\u3018\u301A\u301D' + '\u301D\uFD3E\uFE17\uFE35\uFE37\uFE39\uFE3B\uFE3D\uFE3F\uFE41' + '\uFE43\uFE47\uFE59\uFE5B\uFE5D\uFF08\uFF3B\uFF5B\uFF5F\uFF62' + '\xAB\u2018\u201C\u2039\u2E02\u2E04\u2E09\u2E0C\u2E1C\u2E20' + '\u201A\u201E\xBB\u2019\u201D\u203A\u2E03\u2E05\u2E0A\u2E0D' + '\u2E1D\u2E21\u201B\u201F';

var PunctuationClosers = '"\')>\\]}\u0F3B\u0F3D\u169C\u2046\u207E\u208E\u232A\u2769' + '\u276B\u276D\u276F\u2771\u2773\u2775\u27C6\u27E7\u27E9\u27EB' + '\u27ED\u27EF\u2984\u2986\u2988\u298A\u298C\u298E\u2990\u2992' + '\u2994\u2996\u2998\u29D9\u29DB\u29FD\u2E23\u2E25\u2E27\u2E29' + '\u3009\u300B\u300D\u300F\u3011\u3015\u3017\u3019\u301B\u301E' + '\u301F\uFD3F\uFE18\uFE36\uFE38\uFE3A\uFE3C\uFE3E\uFE40\uFE42' + '\uFE44\uFE48\uFE5A\uFE5C\uFE5E\uFF09\uFF3D\uFF5D\uFF60\uFF63' + '\xBB\u2019\u201D\u203A\u2E03\u2E05\u2E0A\u2E0D\u2E1D\u2E21' + '\u201B\u201F\xAB\u2018\u201C\u2039\u2E02\u2E04\u2E09\u2E0C' + '\u2E1C\u2E20\u201A\u201E';

var PunctuationOpenerToCloser = {};
var PunctuationCloserToOpener = {};

for (var i = 0; i < PunctuationOpeners.length; i++) {
  var opener = PunctuationOpeners[i];
  var closer = PunctuationClosers[i];
  PunctuationOpenerToCloser[opener] = closer;
  PunctuationOpenerToCloser[closer] = opener;
}

var PunctuationDelimiters = '\\-/:\u058A\xA1\xB7\xBF\u037E\u0387\u055A-\u055F\u0589' + '\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C' + '\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D' + '\u07F7-\u07F9\u0830-\u083E\u0964\u0965\u0970\u0DF4\u0E4F' + '\u0E5A\u0E5B\u0F04-\u0F12\u0F85\u0FD0-\u0FD4\u104A-\u104F' + '\u10FB\u1361-\u1368\u1400\u166D\u166E\u16EB-\u16ED\u1735' + '\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945' + '\u19DE\u19DF\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-' + '\u1B60\u1C3B-\u1C3F\u1C7E\u1C7F\u1CD3\u2010-\u2017\u2020-' + '\u2027\u2030-\u2038\u203B-\u203E\u2041-\u2043\u2047-' + '\u2051\u2053\u2055-\u205E\u2CF9-\u2CFC\u2CFE\u2CFF\u2E00' + '\u2E01\u2E06-\u2E08\u2E0B\u2E0E-\u2E1B\u2E1E\u2E1F\u2E2A-' + '\u2E2E\u2E30\u2E31\u3001-\u3003\u301C\u3030\u303D\u30A0' + '\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7' + '\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA92E\uA92F\uA95F' + '\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uABEB' + '\uFE10-\uFE16\uFE19\uFE30-\uFE32\uFE45\uFE46\uFE49-\uFE4C' + '\uFE50-\uFE52\uFE54-\uFE58\uFE5F-\uFE61\uFE63\uFE68\uFE6A' + '\uFE6B\uFF01-\uFF03\uFF05-\uFF07\uFF0A\uFF0C-\uFF0F\uFF1A' + '\uFF1B\uFF1F\uFF20\uFF3C\uFF61\uFF64\uFF65';

var PunctuationDelimiterSet = {};
for (var _i = 0; _i < PunctuationOpeners.length; _i++) {
  PunctuationDelimiterSet[PunctuationDelimiters[_i]] = true;
}

var PunctuationClosingDelimiters = '\\\\.,;!?';

var PunctuationQuotePairs = {
  '\xbb': '\xbb',
  '\u2018': '\u201A',
  '\u2019': '\u2019',
  '\u201A': '\u2018\u2019',
  '\u201C': '\u201E',
  '\u201E': '\u201C\u201D',
  '\u201D': '\u201D',
  '\u203A': '\u203A'
};

var PunctuationStartStringPrefix = new RegExp('\\s|[' + PunctuationOpeners + PunctuationDelimiters + ']');

var PunctuationEndStringSuffix = new RegExp('\\s|[' + PunctuationClosingDelimiters + ('' + PunctuationDelimiters + PunctuationClosers + ']'));

var ParserUtil = {
  calcIndentSize: function calcIndentSize(str) {
    var tabStop = 8;
    return _lodash2.default.reduce(str, function (total, c) {
      if (c === '\t') {
        return total + tabStop - (total + tabStop) % tabStop;
      }
      return total + 1;
    }, 0);
  },
  isPunctuationOpener: function isPunctuationOpener(c) {
    return c in PunctuationOpenerToCloser;
  },
  isPunctuationCloser: function isPunctuationCloser(c) {
    return c in PunctuationCloserToOpener;
  },
  isPunctuationDelimiter: function isPunctuationDelimiter(c) {
    return c in PunctuationDelimiterSet;
  },
  isMatchPunctuations: function isMatchPunctuations(c1, c2) {
    return PunctuationOpenerToCloser[c1] === c2 || c1 in PunctuationQuotePairs && PunctuationQuotePairs[c1].indexOf(c2) !== -1;
  },
  isInlineMarkupPrefix: function isInlineMarkupPrefix(c) {
    return PunctuationStartStringPrefix.test(c);
  },
  isInlineMarkupSuffix: function isInlineMarkupSuffix(c) {
    return PunctuationEndStringSuffix.test(c);
  },
  isUpperRomanNumber: function isUpperRomanNumber(s) {
    return (/^M{0,3}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$/.test(s)
    );
  },
  isLowerRomanNumber: function isLowerRomanNumber(s) {
    return (/^m{0,3}(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})$/.test(s)
    );
  },
  romanToNumber: function romanToNumber(s) {
    var values = [['M', 1000], ['CM', 900], ['D', 500], ['CD', 400], ['C', 100], ['XC', 90], ['L', 50], ['XL', 40], ['X', 10], ['IX', 9], ['V', 5], ['IV', 4], ['I', 1]];
    var result = 0;
    var str = s;

    for (var _i2 = 0; _i2 < values.length; _i2++) {
      var _values$_i = _slicedToArray(values[_i2], 2),
          key = _values$_i[0],
          value = _values$_i[1];

      var regex = new RegExp('^' + key);
      while (str.match(regex)) {
        result += value;
        str = str.replace(regex, '');
      }
    }
    return result;
  },
  numberToRoman: function numberToRoman(d) {
    var values = [['M', 1000], ['CM', 900], ['D', 500], ['CD', 400], ['C', 100], ['XC', 90], ['L', 50], ['XL', 40], ['X', 10], ['IX', 9], ['V', 5], ['IV', 4], ['I', 1]];
    var rest = d;
    var result = '';
    for (var _i3 = 0; _i3 < values.length; _i3++) {
      var _values$_i2 = _slicedToArray(values[_i3], 2),
          key = _values$_i2[0],
          value = _values$_i2[1];

      while (rest >= value) {
        result += key;
        rest -= value;
      }
    }
    return result;
  }
};

exports.default = ParserUtil;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9QYXJzZXJVdGlsLmpzIl0sIm5hbWVzIjpbIlB1bmN0dWF0aW9uT3BlbmVycyIsIlB1bmN0dWF0aW9uQ2xvc2VycyIsIlB1bmN0dWF0aW9uT3BlbmVyVG9DbG9zZXIiLCJQdW5jdHVhdGlvbkNsb3NlclRvT3BlbmVyIiwiaSIsImxlbmd0aCIsIm9wZW5lciIsImNsb3NlciIsIlB1bmN0dWF0aW9uRGVsaW1pdGVycyIsIlB1bmN0dWF0aW9uRGVsaW1pdGVyU2V0IiwiUHVuY3R1YXRpb25DbG9zaW5nRGVsaW1pdGVycyIsIlB1bmN0dWF0aW9uUXVvdGVQYWlycyIsIlB1bmN0dWF0aW9uU3RhcnRTdHJpbmdQcmVmaXgiLCJSZWdFeHAiLCJQdW5jdHVhdGlvbkVuZFN0cmluZ1N1ZmZpeCIsIlBhcnNlclV0aWwiLCJjYWxjSW5kZW50U2l6ZSIsInN0ciIsInRhYlN0b3AiLCJyZWR1Y2UiLCJ0b3RhbCIsImMiLCJpc1B1bmN0dWF0aW9uT3BlbmVyIiwiaXNQdW5jdHVhdGlvbkNsb3NlciIsImlzUHVuY3R1YXRpb25EZWxpbWl0ZXIiLCJpc01hdGNoUHVuY3R1YXRpb25zIiwiYzEiLCJjMiIsImluZGV4T2YiLCJpc0lubGluZU1hcmt1cFByZWZpeCIsInRlc3QiLCJpc0lubGluZU1hcmt1cFN1ZmZpeCIsImlzVXBwZXJSb21hbk51bWJlciIsInMiLCJpc0xvd2VyUm9tYW5OdW1iZXIiLCJyb21hblRvTnVtYmVyIiwidmFsdWVzIiwicmVzdWx0Iiwia2V5IiwidmFsdWUiLCJyZWdleCIsIm1hdGNoIiwicmVwbGFjZSIsIm51bWJlclRvUm9tYW4iLCJkIiwicmVzdCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQTs7Ozs7O0FBRUEsSUFBTUEscUJBQ0EsOERBQ0EsOERBREEsR0FFQSw4REFGQSxHQUdBLDhEQUhBLEdBSUEsOERBSkEsR0FLQSw4REFMQSxHQU1BLDhEQU5BLEdBT0EsNERBUEEsR0FRQSw0REFSQSxHQVNBLDBCQVZOOztBQVlBLElBQU1DLHFCQUNBLDhEQUNBLDhEQURBLEdBRUEsOERBRkEsR0FHQSw4REFIQSxHQUlBLDhEQUpBLEdBS0EsOERBTEEsR0FNQSw4REFOQSxHQU9BLDREQVBBLEdBUUEsNERBUkEsR0FTQSwwQkFWTjs7QUFZQSxJQUFNQyw0QkFBNEIsRUFBbEM7QUFDQSxJQUFNQyw0QkFBNEIsRUFBbEM7O0FBRUEsS0FBSyxJQUFJQyxJQUFJLENBQWIsRUFBZ0JBLElBQUlKLG1CQUFtQkssTUFBdkMsRUFBK0NELEdBQS9DLEVBQW9EO0FBQ2xELE1BQU1FLFNBQVNOLG1CQUFtQkksQ0FBbkIsQ0FBZjtBQUNBLE1BQU1HLFNBQVNOLG1CQUFtQkcsQ0FBbkIsQ0FBZjtBQUNBRiw0QkFBMEJJLE1BQTFCLElBQW9DQyxNQUFwQztBQUNBTCw0QkFBMEJLLE1BQTFCLElBQW9DRCxNQUFwQztBQUNEOztBQUVELElBQU1FLHdCQUF3QiwyREFDeEIsd0RBRHdCLEdBRXhCLDBEQUZ3QixHQUd4QiwwREFId0IsR0FJeEIsMkRBSndCLEdBS3hCLDBEQUx3QixHQU14QiwyREFOd0IsR0FPeEIsMkRBUHdCLEdBUXhCLDJEQVJ3QixHQVN4QixzREFUd0IsR0FVeEIsMERBVndCLEdBV3hCLDJEQVh3QixHQVl4Qix5REFad0IsR0FheEIsMERBYndCLEdBY3hCLDBEQWR3QixHQWV4QiwwREFmd0IsR0FnQnhCLDJEQWhCd0IsR0FpQnhCLDJEQWpCd0IsR0FrQnhCLDJEQWxCd0IsR0FtQnhCLDRDQW5CTjs7QUFxQkEsSUFBTUMsMEJBQTBCLEVBQWhDO0FBQ0EsS0FBSyxJQUFJTCxLQUFJLENBQWIsRUFBZ0JBLEtBQUlKLG1CQUFtQkssTUFBdkMsRUFBK0NELElBQS9DLEVBQW9EO0FBQ2xESywwQkFBd0JELHNCQUFzQkosRUFBdEIsQ0FBeEIsSUFBb0QsSUFBcEQ7QUFDRDs7QUFFRCxJQUFNTSwrQkFBK0IsV0FBckM7O0FBRUEsSUFBTUMsd0JBQXdCO0FBQzVCLFVBQVEsTUFEb0I7QUFFNUIsWUFBVSxRQUZrQjtBQUc1QixZQUFVLFFBSGtCO0FBSTVCLFlBQVUsY0FKa0I7QUFLNUIsWUFBVSxRQUxrQjtBQU01QixZQUFVLGNBTmtCO0FBTzVCLFlBQVUsUUFQa0I7QUFRNUIsWUFBVTtBQVJrQixDQUE5Qjs7QUFXQSxJQUFNQywrQkFDQSxJQUFJQyxNQUFKLFdBQW1CYixrQkFBbkIsR0FBd0NRLHFCQUF4QyxPQUROOztBQUdBLElBQU1NLDZCQUNFLElBQUlELE1BQUosQ0FBVyxVQUFRSCw0QkFBUixTQUNHRixxQkFESCxHQUMyQlAsa0JBRDNCLE9BQVgsQ0FEUjs7QUFJQSxJQUFNYyxhQUFhO0FBQ2pCQyxnQkFEaUIsMEJBQ0ZDLEdBREUsRUFDRztBQUNsQixRQUFNQyxVQUFVLENBQWhCO0FBQ0EsV0FBTyxpQkFBRUMsTUFBRixDQUFTRixHQUFULEVBQWMsVUFBQ0csS0FBRCxFQUFRQyxDQUFSLEVBQWM7QUFDakMsVUFBSUEsTUFBTSxJQUFWLEVBQWdCO0FBQ2QsZUFBUUQsUUFBUUYsT0FBVCxHQUFxQixDQUFDRSxRQUFRRixPQUFULElBQW9CQSxPQUFoRDtBQUNEO0FBQ0QsYUFBT0UsUUFBUSxDQUFmO0FBQ0QsS0FMTSxFQUtKLENBTEksQ0FBUDtBQU1ELEdBVGdCO0FBV2pCRSxxQkFYaUIsK0JBV0dELENBWEgsRUFXTTtBQUNyQixXQUFPQSxLQUFLbkIseUJBQVo7QUFDRCxHQWJnQjtBQWVqQnFCLHFCQWZpQiwrQkFlR0YsQ0FmSCxFQWVNO0FBQ3JCLFdBQU9BLEtBQUtsQix5QkFBWjtBQUNELEdBakJnQjtBQW1CakJxQix3QkFuQmlCLGtDQW1CTUgsQ0FuQk4sRUFtQlM7QUFDeEIsV0FBT0EsS0FBS1osdUJBQVo7QUFDRCxHQXJCZ0I7QUF1QmpCZ0IscUJBdkJpQiwrQkF1QkdDLEVBdkJILEVBdUJPQyxFQXZCUCxFQXVCVztBQUMxQixXQUFPekIsMEJBQTBCd0IsRUFBMUIsTUFBa0NDLEVBQWxDLElBQ0pELE1BQU1mLHFCQUFOLElBQStCQSxzQkFBc0JlLEVBQXRCLEVBQTBCRSxPQUExQixDQUFrQ0QsRUFBbEMsTUFBMEMsQ0FBQyxDQUQ3RTtBQUVELEdBMUJnQjtBQTRCakJFLHNCQTVCaUIsZ0NBNEJJUixDQTVCSixFQTRCTztBQUN0QixXQUFPVCw2QkFBNkJrQixJQUE3QixDQUFrQ1QsQ0FBbEMsQ0FBUDtBQUNELEdBOUJnQjtBQWdDakJVLHNCQWhDaUIsZ0NBZ0NJVixDQWhDSixFQWdDTztBQUN0QixXQUFPUCwyQkFBMkJnQixJQUEzQixDQUFnQ1QsQ0FBaEMsQ0FBUDtBQUNELEdBbENnQjtBQW9DakJXLG9CQXBDaUIsOEJBb0NFQyxDQXBDRixFQW9DSztBQUNwQixXQUFPLDREQUEyREgsSUFBM0QsQ0FBZ0VHLENBQWhFO0FBQVA7QUFDRCxHQXRDZ0I7QUF3Q2pCQyxvQkF4Q2lCLDhCQXdDRUQsQ0F4Q0YsRUF3Q0s7QUFDcEIsV0FBTyw0REFBMkRILElBQTNELENBQWdFRyxDQUFoRTtBQUFQO0FBQ0QsR0ExQ2dCO0FBNENqQkUsZUE1Q2lCLHlCQTRDSEYsQ0E1Q0csRUE0Q0E7QUFDZixRQUFNRyxTQUFTLENBQUMsQ0FBQyxHQUFELEVBQU0sSUFBTixDQUFELEVBQWMsQ0FBQyxJQUFELEVBQU8sR0FBUCxDQUFkLEVBQTJCLENBQUMsR0FBRCxFQUFNLEdBQU4sQ0FBM0IsRUFBdUMsQ0FBQyxJQUFELEVBQU8sR0FBUCxDQUF2QyxFQUNDLENBQUMsR0FBRCxFQUFNLEdBQU4sQ0FERCxFQUNhLENBQUMsSUFBRCxFQUFPLEVBQVAsQ0FEYixFQUN5QixDQUFDLEdBQUQsRUFBTSxFQUFOLENBRHpCLEVBQ29DLENBQUMsSUFBRCxFQUFPLEVBQVAsQ0FEcEMsRUFFQyxDQUFDLEdBQUQsRUFBTSxFQUFOLENBRkQsRUFFWSxDQUFDLElBQUQsRUFBTyxDQUFQLENBRlosRUFFdUIsQ0FBQyxHQUFELEVBQU0sQ0FBTixDQUZ2QixFQUVpQyxDQUFDLElBQUQsRUFBTyxDQUFQLENBRmpDLEVBR0MsQ0FBQyxHQUFELEVBQU0sQ0FBTixDQUhELENBQWY7QUFJQSxRQUFJQyxTQUFTLENBQWI7QUFDQSxRQUFJcEIsTUFBTWdCLENBQVY7O0FBRUEsU0FBSyxJQUFJN0IsTUFBSSxDQUFiLEVBQWdCQSxNQUFJZ0MsT0FBTy9CLE1BQTNCLEVBQW1DRCxLQUFuQyxFQUF3QztBQUFBLHNDQUNqQmdDLE9BQU9oQyxHQUFQLENBRGlCO0FBQUEsVUFDL0JrQyxHQUQrQjtBQUFBLFVBQzFCQyxLQUQwQjs7QUFFdEMsVUFBTUMsUUFBUSxJQUFJM0IsTUFBSixPQUFleUIsR0FBZixDQUFkO0FBQ0EsYUFBT3JCLElBQUl3QixLQUFKLENBQVVELEtBQVYsQ0FBUCxFQUF5QjtBQUN2Qkgsa0JBQVVFLEtBQVY7QUFDQXRCLGNBQU1BLElBQUl5QixPQUFKLENBQVlGLEtBQVosRUFBbUIsRUFBbkIsQ0FBTjtBQUNEO0FBQ0Y7QUFDRCxXQUFPSCxNQUFQO0FBQ0QsR0E3RGdCO0FBK0RqQk0sZUEvRGlCLHlCQStESEMsQ0EvREcsRUErREE7QUFDZixRQUFNUixTQUFTLENBQUMsQ0FBQyxHQUFELEVBQU0sSUFBTixDQUFELEVBQWMsQ0FBQyxJQUFELEVBQU8sR0FBUCxDQUFkLEVBQTJCLENBQUMsR0FBRCxFQUFNLEdBQU4sQ0FBM0IsRUFBdUMsQ0FBQyxJQUFELEVBQU8sR0FBUCxDQUF2QyxFQUNDLENBQUMsR0FBRCxFQUFNLEdBQU4sQ0FERCxFQUNhLENBQUMsSUFBRCxFQUFPLEVBQVAsQ0FEYixFQUN5QixDQUFDLEdBQUQsRUFBTSxFQUFOLENBRHpCLEVBQ29DLENBQUMsSUFBRCxFQUFPLEVBQVAsQ0FEcEMsRUFFQyxDQUFDLEdBQUQsRUFBTSxFQUFOLENBRkQsRUFFWSxDQUFDLElBQUQsRUFBTyxDQUFQLENBRlosRUFFdUIsQ0FBQyxHQUFELEVBQU0sQ0FBTixDQUZ2QixFQUVpQyxDQUFDLElBQUQsRUFBTyxDQUFQLENBRmpDLEVBR0MsQ0FBQyxHQUFELEVBQU0sQ0FBTixDQUhELENBQWY7QUFJQSxRQUFJUyxPQUFPRCxDQUFYO0FBQ0EsUUFBSVAsU0FBUyxFQUFiO0FBQ0EsU0FBSyxJQUFJakMsTUFBSSxDQUFiLEVBQWdCQSxNQUFJZ0MsT0FBTy9CLE1BQTNCLEVBQW1DRCxLQUFuQyxFQUF3QztBQUFBLHVDQUNqQmdDLE9BQU9oQyxHQUFQLENBRGlCO0FBQUEsVUFDL0JrQyxHQUQrQjtBQUFBLFVBQzFCQyxLQUQwQjs7QUFFdEMsYUFBT00sUUFBUU4sS0FBZixFQUFzQjtBQUNwQkYsa0JBQVVDLEdBQVY7QUFDQU8sZ0JBQVFOLEtBQVI7QUFDRDtBQUNGO0FBQ0QsV0FBT0YsTUFBUDtBQUNEO0FBOUVnQixDQUFuQjs7a0JBaUZldEIsVSIsImZpbGUiOiJQYXJzZXJVdGlsLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IF8gZnJvbSAnbG9kYXNoJztcblxuY29uc3QgUHVuY3R1YXRpb25PcGVuZXJzID1cbiAgICAgICdcIlxcJyg8XFxcXFt7XFx1MGYzYVxcdTBmM2NcXHUxNjliXFx1MjA0NVxcdTIwN2RcXHUyMDhkXFx1MjMyOVxcdTI3NjgnICtcbiAgICAgICdcXHUyNzZhXFx1Mjc2Y1xcdTI3NmVcXHUyNzcwXFx1Mjc3MlxcdTI3NzRcXHUyN2M1XFx1MjdlNlxcdTI3ZThcXHUyN2VhJyArXG4gICAgICAnXFx1MjdlY1xcdTI3ZWVcXHUyOTgzXFx1Mjk4NVxcdTI5ODdcXHUyOTg5XFx1Mjk4YlxcdTI5OGRcXHUyOThmXFx1Mjk5MScgK1xuICAgICAgJ1xcdTI5OTNcXHUyOTk1XFx1Mjk5N1xcdTI5ZDhcXHUyOWRhXFx1MjlmY1xcdTJlMjJcXHUyZTI0XFx1MmUyNlxcdTJlMjgnICtcbiAgICAgICdcXHUzMDA4XFx1MzAwYVxcdTMwMGNcXHUzMDBlXFx1MzAxMFxcdTMwMTRcXHUzMDE2XFx1MzAxOFxcdTMwMWFcXHUzMDFkJyArXG4gICAgICAnXFx1MzAxZFxcdWZkM2VcXHVmZTE3XFx1ZmUzNVxcdWZlMzdcXHVmZTM5XFx1ZmUzYlxcdWZlM2RcXHVmZTNmXFx1ZmU0MScgK1xuICAgICAgJ1xcdWZlNDNcXHVmZTQ3XFx1ZmU1OVxcdWZlNWJcXHVmZTVkXFx1ZmYwOFxcdWZmM2JcXHVmZjViXFx1ZmY1ZlxcdWZmNjInICtcbiAgICAgICdcXHhhYlxcdTIwMThcXHUyMDFjXFx1MjAzOVxcdTJlMDJcXHUyZTA0XFx1MmUwOVxcdTJlMGNcXHUyZTFjXFx1MmUyMCcgK1xuICAgICAgJ1xcdTIwMWFcXHUyMDFlXFx4YmJcXHUyMDE5XFx1MjAxZFxcdTIwM2FcXHUyZTAzXFx1MmUwNVxcdTJlMGFcXHUyZTBkJyArXG4gICAgICAnXFx1MmUxZFxcdTJlMjFcXHUyMDFiXFx1MjAxZic7XG5cbmNvbnN0IFB1bmN0dWF0aW9uQ2xvc2VycyA9XG4gICAgICAnXCJcXCcpPlxcXFxdfVxcdTBmM2JcXHUwZjNkXFx1MTY5Y1xcdTIwNDZcXHUyMDdlXFx1MjA4ZVxcdTIzMmFcXHUyNzY5JyArXG4gICAgICAnXFx1Mjc2YlxcdTI3NmRcXHUyNzZmXFx1Mjc3MVxcdTI3NzNcXHUyNzc1XFx1MjdjNlxcdTI3ZTdcXHUyN2U5XFx1MjdlYicgK1xuICAgICAgJ1xcdTI3ZWRcXHUyN2VmXFx1Mjk4NFxcdTI5ODZcXHUyOTg4XFx1Mjk4YVxcdTI5OGNcXHUyOThlXFx1Mjk5MFxcdTI5OTInICtcbiAgICAgICdcXHUyOTk0XFx1Mjk5NlxcdTI5OThcXHUyOWQ5XFx1MjlkYlxcdTI5ZmRcXHUyZTIzXFx1MmUyNVxcdTJlMjdcXHUyZTI5JyArXG4gICAgICAnXFx1MzAwOVxcdTMwMGJcXHUzMDBkXFx1MzAwZlxcdTMwMTFcXHUzMDE1XFx1MzAxN1xcdTMwMTlcXHUzMDFiXFx1MzAxZScgK1xuICAgICAgJ1xcdTMwMWZcXHVmZDNmXFx1ZmUxOFxcdWZlMzZcXHVmZTM4XFx1ZmUzYVxcdWZlM2NcXHVmZTNlXFx1ZmU0MFxcdWZlNDInICtcbiAgICAgICdcXHVmZTQ0XFx1ZmU0OFxcdWZlNWFcXHVmZTVjXFx1ZmU1ZVxcdWZmMDlcXHVmZjNkXFx1ZmY1ZFxcdWZmNjBcXHVmZjYzJyArXG4gICAgICAnXFx4YmJcXHUyMDE5XFx1MjAxZFxcdTIwM2FcXHUyZTAzXFx1MmUwNVxcdTJlMGFcXHUyZTBkXFx1MmUxZFxcdTJlMjEnICtcbiAgICAgICdcXHUyMDFiXFx1MjAxZlxceGFiXFx1MjAxOFxcdTIwMWNcXHUyMDM5XFx1MmUwMlxcdTJlMDRcXHUyZTA5XFx1MmUwYycgK1xuICAgICAgJ1xcdTJlMWNcXHUyZTIwXFx1MjAxYVxcdTIwMWUnO1xuXG5jb25zdCBQdW5jdHVhdGlvbk9wZW5lclRvQ2xvc2VyID0ge307XG5jb25zdCBQdW5jdHVhdGlvbkNsb3NlclRvT3BlbmVyID0ge307XG5cbmZvciAobGV0IGkgPSAwOyBpIDwgUHVuY3R1YXRpb25PcGVuZXJzLmxlbmd0aDsgaSsrKSB7XG4gIGNvbnN0IG9wZW5lciA9IFB1bmN0dWF0aW9uT3BlbmVyc1tpXTtcbiAgY29uc3QgY2xvc2VyID0gUHVuY3R1YXRpb25DbG9zZXJzW2ldO1xuICBQdW5jdHVhdGlvbk9wZW5lclRvQ2xvc2VyW29wZW5lcl0gPSBjbG9zZXI7XG4gIFB1bmN0dWF0aW9uT3BlbmVyVG9DbG9zZXJbY2xvc2VyXSA9IG9wZW5lcjtcbn1cblxuY29uc3QgUHVuY3R1YXRpb25EZWxpbWl0ZXJzID0gJ1xcXFwtLzpcXHUwNThhXFx4YTFcXHhiN1xceGJmXFx1MDM3ZVxcdTAzODdcXHUwNTVhLVxcdTA1NWZcXHUwNTg5JyArXG4gICAgICAnXFx1MDViZVxcdTA1YzBcXHUwNWMzXFx1MDVjNlxcdTA1ZjNcXHUwNWY0XFx1MDYwOVxcdTA2MGFcXHUwNjBjJyArXG4gICAgICAnXFx1MDYwZFxcdTA2MWJcXHUwNjFlXFx1MDYxZlxcdTA2NmEtXFx1MDY2ZFxcdTA2ZDRcXHUwNzAwLVxcdTA3MGQnICtcbiAgICAgICdcXHUwN2Y3LVxcdTA3ZjlcXHUwODMwLVxcdTA4M2VcXHUwOTY0XFx1MDk2NVxcdTA5NzBcXHUwZGY0XFx1MGU0ZicgK1xuICAgICAgJ1xcdTBlNWFcXHUwZTViXFx1MGYwNC1cXHUwZjEyXFx1MGY4NVxcdTBmZDAtXFx1MGZkNFxcdTEwNGEtXFx1MTA0ZicgK1xuICAgICAgJ1xcdTEwZmJcXHUxMzYxLVxcdTEzNjhcXHUxNDAwXFx1MTY2ZFxcdTE2NmVcXHUxNmViLVxcdTE2ZWRcXHUxNzM1JyArXG4gICAgICAnXFx1MTczNlxcdTE3ZDQtXFx1MTdkNlxcdTE3ZDgtXFx1MTdkYVxcdTE4MDAtXFx1MTgwYVxcdTE5NDRcXHUxOTQ1JyArXG4gICAgICAnXFx1MTlkZVxcdTE5ZGZcXHUxYTFlXFx1MWExZlxcdTFhYTAtXFx1MWFhNlxcdTFhYTgtXFx1MWFhZFxcdTFiNWEtJyArXG4gICAgICAnXFx1MWI2MFxcdTFjM2ItXFx1MWMzZlxcdTFjN2VcXHUxYzdmXFx1MWNkM1xcdTIwMTAtXFx1MjAxN1xcdTIwMjAtJyArXG4gICAgICAnXFx1MjAyN1xcdTIwMzAtXFx1MjAzOFxcdTIwM2ItXFx1MjAzZVxcdTIwNDEtXFx1MjA0M1xcdTIwNDctJyArXG4gICAgICAnXFx1MjA1MVxcdTIwNTNcXHUyMDU1LVxcdTIwNWVcXHUyY2Y5LVxcdTJjZmNcXHUyY2ZlXFx1MmNmZlxcdTJlMDAnICtcbiAgICAgICdcXHUyZTAxXFx1MmUwNi1cXHUyZTA4XFx1MmUwYlxcdTJlMGUtXFx1MmUxYlxcdTJlMWVcXHUyZTFmXFx1MmUyYS0nICtcbiAgICAgICdcXHUyZTJlXFx1MmUzMFxcdTJlMzFcXHUzMDAxLVxcdTMwMDNcXHUzMDFjXFx1MzAzMFxcdTMwM2RcXHUzMGEwJyArXG4gICAgICAnXFx1MzBmYlxcdWE0ZmVcXHVhNGZmXFx1YTYwZC1cXHVhNjBmXFx1YTY3M1xcdWE2N2VcXHVhNmYyLVxcdWE2ZjcnICtcbiAgICAgICdcXHVhODc0LVxcdWE4NzdcXHVhOGNlXFx1YThjZlxcdWE4ZjgtXFx1YThmYVxcdWE5MmVcXHVhOTJmXFx1YTk1ZicgK1xuICAgICAgJ1xcdWE5YzEtXFx1YTljZFxcdWE5ZGVcXHVhOWRmXFx1YWE1Yy1cXHVhYTVmXFx1YWFkZVxcdWFhZGZcXHVhYmViJyArXG4gICAgICAnXFx1ZmUxMC1cXHVmZTE2XFx1ZmUxOVxcdWZlMzAtXFx1ZmUzMlxcdWZlNDVcXHVmZTQ2XFx1ZmU0OS1cXHVmZTRjJyArXG4gICAgICAnXFx1ZmU1MC1cXHVmZTUyXFx1ZmU1NC1cXHVmZTU4XFx1ZmU1Zi1cXHVmZTYxXFx1ZmU2M1xcdWZlNjhcXHVmZTZhJyArXG4gICAgICAnXFx1ZmU2YlxcdWZmMDEtXFx1ZmYwM1xcdWZmMDUtXFx1ZmYwN1xcdWZmMGFcXHVmZjBjLVxcdWZmMGZcXHVmZjFhJyArXG4gICAgICAnXFx1ZmYxYlxcdWZmMWZcXHVmZjIwXFx1ZmYzY1xcdWZmNjFcXHVmZjY0XFx1ZmY2NSc7XG5cbmNvbnN0IFB1bmN0dWF0aW9uRGVsaW1pdGVyU2V0ID0ge307XG5mb3IgKGxldCBpID0gMDsgaSA8IFB1bmN0dWF0aW9uT3BlbmVycy5sZW5ndGg7IGkrKykge1xuICBQdW5jdHVhdGlvbkRlbGltaXRlclNldFtQdW5jdHVhdGlvbkRlbGltaXRlcnNbaV1dID0gdHJ1ZTtcbn1cblxuY29uc3QgUHVuY3R1YXRpb25DbG9zaW5nRGVsaW1pdGVycyA9ICdcXFxcXFxcXC4sOyE/JztcblxuY29uc3QgUHVuY3R1YXRpb25RdW90ZVBhaXJzID0ge1xuICAnXFx4YmInOiAnXFx4YmInLFxuICAnXFx1MjAxOCc6ICdcXHUyMDFhJyxcbiAgJ1xcdTIwMTknOiAnXFx1MjAxOScsXG4gICdcXHUyMDFhJzogJ1xcdTIwMThcXHUyMDE5JyxcbiAgJ1xcdTIwMWMnOiAnXFx1MjAxZScsXG4gICdcXHUyMDFlJzogJ1xcdTIwMWNcXHUyMDFkJyxcbiAgJ1xcdTIwMWQnOiAnXFx1MjAxZCcsXG4gICdcXHUyMDNhJzogJ1xcdTIwM2EnLFxufTtcblxuY29uc3QgUHVuY3R1YXRpb25TdGFydFN0cmluZ1ByZWZpeCA9XG4gICAgICBuZXcgUmVnRXhwKGBcXFxcc3xbJHtQdW5jdHVhdGlvbk9wZW5lcnN9JHtQdW5jdHVhdGlvbkRlbGltaXRlcnN9XWApO1xuXG5jb25zdCBQdW5jdHVhdGlvbkVuZFN0cmluZ1N1ZmZpeCA9XG4gICAgICAgIG5ldyBSZWdFeHAoYFxcXFxzfFske1B1bmN0dWF0aW9uQ2xvc2luZ0RlbGltaXRlcnN9YCArXG4gICAgICAgICAgICAgICAgICAgYCR7UHVuY3R1YXRpb25EZWxpbWl0ZXJzfSR7UHVuY3R1YXRpb25DbG9zZXJzfV1gKTtcblxuY29uc3QgUGFyc2VyVXRpbCA9IHtcbiAgY2FsY0luZGVudFNpemUoc3RyKSB7XG4gICAgY29uc3QgdGFiU3RvcCA9IDg7XG4gICAgcmV0dXJuIF8ucmVkdWNlKHN0ciwgKHRvdGFsLCBjKSA9PiB7XG4gICAgICBpZiAoYyA9PT0gJ1xcdCcpIHtcbiAgICAgICAgcmV0dXJuICh0b3RhbCArIHRhYlN0b3ApIC0gKCh0b3RhbCArIHRhYlN0b3ApICUgdGFiU3RvcCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdG90YWwgKyAxO1xuICAgIH0sIDApO1xuICB9LFxuXG4gIGlzUHVuY3R1YXRpb25PcGVuZXIoYykge1xuICAgIHJldHVybiBjIGluIFB1bmN0dWF0aW9uT3BlbmVyVG9DbG9zZXI7XG4gIH0sXG5cbiAgaXNQdW5jdHVhdGlvbkNsb3NlcihjKSB7XG4gICAgcmV0dXJuIGMgaW4gUHVuY3R1YXRpb25DbG9zZXJUb09wZW5lcjtcbiAgfSxcblxuICBpc1B1bmN0dWF0aW9uRGVsaW1pdGVyKGMpIHtcbiAgICByZXR1cm4gYyBpbiBQdW5jdHVhdGlvbkRlbGltaXRlclNldDtcbiAgfSxcblxuICBpc01hdGNoUHVuY3R1YXRpb25zKGMxLCBjMikge1xuICAgIHJldHVybiBQdW5jdHVhdGlvbk9wZW5lclRvQ2xvc2VyW2MxXSA9PT0gYzIgfHxcbiAgICAgIChjMSBpbiBQdW5jdHVhdGlvblF1b3RlUGFpcnMgJiYgUHVuY3R1YXRpb25RdW90ZVBhaXJzW2MxXS5pbmRleE9mKGMyKSAhPT0gLTEpO1xuICB9LFxuXG4gIGlzSW5saW5lTWFya3VwUHJlZml4KGMpIHtcbiAgICByZXR1cm4gUHVuY3R1YXRpb25TdGFydFN0cmluZ1ByZWZpeC50ZXN0KGMpO1xuICB9LFxuXG4gIGlzSW5saW5lTWFya3VwU3VmZml4KGMpIHtcbiAgICByZXR1cm4gUHVuY3R1YXRpb25FbmRTdHJpbmdTdWZmaXgudGVzdChjKTtcbiAgfSxcblxuICBpc1VwcGVyUm9tYW5OdW1iZXIocykge1xuICAgIHJldHVybiAvXk17MCwzfShDTXxDRHxEP0N7MCwzfSkoWEN8WEx8TD9YezAsM30pKElYfElWfFY/SXswLDN9KSQvLnRlc3Qocyk7XG4gIH0sXG5cbiAgaXNMb3dlclJvbWFuTnVtYmVyKHMpIHtcbiAgICByZXR1cm4gL15tezAsM30oY218Y2R8ZD9jezAsM30pKHhjfHhsfGw/eHswLDN9KShpeHxpdnx2P2l7MCwzfSkkLy50ZXN0KHMpO1xuICB9LFxuXG4gIHJvbWFuVG9OdW1iZXIocykge1xuICAgIGNvbnN0IHZhbHVlcyA9IFtbJ00nLCAxMDAwXSwgWydDTScsIDkwMF0sIFsnRCcsIDUwMF0sIFsnQ0QnLCA0MDBdLFxuICAgICAgICAgICAgICAgICAgICBbJ0MnLCAxMDBdLCBbJ1hDJywgOTBdLCBbJ0wnLCA1MF0sIFsnWEwnLCA0MF0sXG4gICAgICAgICAgICAgICAgICAgIFsnWCcsIDEwXSwgWydJWCcsIDldLCBbJ1YnLCA1XSwgWydJVicsIDRdLFxuICAgICAgICAgICAgICAgICAgICBbJ0knLCAxXV07XG4gICAgbGV0IHJlc3VsdCA9IDA7XG4gICAgbGV0IHN0ciA9IHM7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHZhbHVlcy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgW2tleSwgdmFsdWVdID0gdmFsdWVzW2ldO1xuICAgICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGBeJHtrZXl9YCk7XG4gICAgICB3aGlsZSAoc3RyLm1hdGNoKHJlZ2V4KSkge1xuICAgICAgICByZXN1bHQgKz0gdmFsdWU7XG4gICAgICAgIHN0ciA9IHN0ci5yZXBsYWNlKHJlZ2V4LCAnJyk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH0sXG5cbiAgbnVtYmVyVG9Sb21hbihkKSB7XG4gICAgY29uc3QgdmFsdWVzID0gW1snTScsIDEwMDBdLCBbJ0NNJywgOTAwXSwgWydEJywgNTAwXSwgWydDRCcsIDQwMF0sXG4gICAgICAgICAgICAgICAgICAgIFsnQycsIDEwMF0sIFsnWEMnLCA5MF0sIFsnTCcsIDUwXSwgWydYTCcsIDQwXSxcbiAgICAgICAgICAgICAgICAgICAgWydYJywgMTBdLCBbJ0lYJywgOV0sIFsnVicsIDVdLCBbJ0lWJywgNF0sXG4gICAgICAgICAgICAgICAgICAgIFsnSScsIDFdXTtcbiAgICBsZXQgcmVzdCA9IGQ7XG4gICAgbGV0IHJlc3VsdCA9ICcnO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmFsdWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBba2V5LCB2YWx1ZV0gPSB2YWx1ZXNbaV07XG4gICAgICB3aGlsZSAocmVzdCA+PSB2YWx1ZSkge1xuICAgICAgICByZXN1bHQgKz0ga2V5O1xuICAgICAgICByZXN0IC09IHZhbHVlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9LFxufTtcblxuZXhwb3J0IGRlZmF1bHQgUGFyc2VyVXRpbDtcbiJdfQ==